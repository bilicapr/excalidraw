{
  "version": 3,
  "sources": ["../../../worker.ts"],
  "sourceRoot": "E:\\Users\\Administrator\\Documents\\GitHub\\excalidraw\\excalidraw-app\\.wrangler\\tmp\\deploy-XPYzJp",
  "sourcesContent": ["import { ExecutionContext } from '@cloudflare/workers-types';\n\nexport interface Env {\n  ASSETS: { fetch: (request: Request) => Promise<Response> };\n}\n\nexport default {\n  async fetch(request: Request, env: Env, ctx: ExecutionContext): Promise<Response> {\n    const url = new URL(request.url);\n\n    // Redirects\n    if (url.pathname.startsWith('/webex/')) {\n      return Response.redirect('https://for-webex.excalidraw.com' + url.pathname.replace('/webex', ''), 301);\n    }\n    \n    const host = request.headers.get('Host');\n    if (host === 'vscode.excalidraw.com') {\n      return Response.redirect('https://marketplace.visualstudio.com/items?itemName=pomdtr.excalidraw-editor', 301);\n    }\n\n    // Serve assets\n    let response = await env.ASSETS.fetch(request);\n\n    // SPA fallback\n    if (response.status === 404 && !url.pathname.startsWith('/assets/')) {\n       const indexRequest = new Request(new URL('/', request.url), request);\n       response = await env.ASSETS.fetch(indexRequest);\n    }\n\n    // Add headers\n    const newHeaders = new Headers(response.headers);\n    \n    // Default headers for all responses\n    if (!newHeaders.has('Access-Control-Allow-Origin')) {\n        newHeaders.set('Access-Control-Allow-Origin', 'https://excalidraw.com');\n    }\n    newHeaders.set('X-Content-Type-Options', 'nosniff');\n    newHeaders.set('Referrer-Policy', 'origin');\n\n    // Font caching and specific CORS\n    if (url.pathname.endsWith('.woff2')) {\n        newHeaders.set('Cache-Control', 'public, max-age=31536000');\n        \n        if (url.pathname.match(/(Virgil|Cascadia|Assistant-Regular).woff2/)) {\n            newHeaders.set('Access-Control-Allow-Origin', '*');\n        } else {\n             newHeaders.set('Access-Control-Allow-Origin', 'https://excalidraw.com');\n        }\n    }\n\n    return new Response(response.body, {\n        status: response.status,\n        statusText: response.statusText,\n        headers: newHeaders\n    });\n  },\n};\n"],
  "mappings": ";AAMA,IAAO,iBAAQ;AAAA,EACb,MAAM,MAAM,SAAkB,KAAU,KAA0C;AAChF,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAG/B,QAAI,IAAI,SAAS,WAAW,SAAS,GAAG;AACtC,aAAO,SAAS,SAAS,qCAAqC,IAAI,SAAS,QAAQ,UAAU,EAAE,GAAG,GAAG;AAAA,IACvG;AAEA,UAAM,OAAO,QAAQ,QAAQ,IAAI,MAAM;AACvC,QAAI,SAAS,yBAAyB;AACpC,aAAO,SAAS,SAAS,gFAAgF,GAAG;AAAA,IAC9G;AAGA,QAAI,WAAW,MAAM,IAAI,OAAO,MAAM,OAAO;AAG7C,QAAI,SAAS,WAAW,OAAO,CAAC,IAAI,SAAS,WAAW,UAAU,GAAG;AAClE,YAAM,eAAe,IAAI,QAAQ,IAAI,IAAI,KAAK,QAAQ,GAAG,GAAG,OAAO;AACnE,iBAAW,MAAM,IAAI,OAAO,MAAM,YAAY;AAAA,IACjD;AAGA,UAAM,aAAa,IAAI,QAAQ,SAAS,OAAO;AAG/C,QAAI,CAAC,WAAW,IAAI,6BAA6B,GAAG;AAChD,iBAAW,IAAI,+BAA+B,wBAAwB;AAAA,IAC1E;AACA,eAAW,IAAI,0BAA0B,SAAS;AAClD,eAAW,IAAI,mBAAmB,QAAQ;AAG1C,QAAI,IAAI,SAAS,SAAS,QAAQ,GAAG;AACjC,iBAAW,IAAI,iBAAiB,0BAA0B;AAE1D,UAAI,IAAI,SAAS,MAAM,2CAA2C,GAAG;AACjE,mBAAW,IAAI,+BAA+B,GAAG;AAAA,MACrD,OAAO;AACF,mBAAW,IAAI,+BAA+B,wBAAwB;AAAA,MAC3E;AAAA,IACJ;AAEA,WAAO,IAAI,SAAS,SAAS,MAAM;AAAA,MAC/B,QAAQ,SAAS;AAAA,MACjB,YAAY,SAAS;AAAA,MACrB,SAAS;AAAA,IACb,CAAC;AAAA,EACH;AACF;",
  "names": []
}
